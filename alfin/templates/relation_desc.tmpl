{{/* gotype: github.com/samlet/petrel/alfin.ModelEntity */}}

// Edges of the {{.Name}}.
{{- range $r := $.Relations }}
//  {{ $r.Type }}: {{ $r.Name }}
{{- end }}
func ({{.Name}}) Edges() []ent.Edge {
    return []ent.Edge{
        {{- range $r := $.Edges }}
            {{- if $r.SelfRelation }}
                edge.To("children", {{$r.RelEntityName}}.Type).
                    From("parent").
                    // Bind the "{{$r.FieldName}}" field to this edge.
                    // Field("{{$r.FieldName|snakecase}}").
                    Unique().Annotations(entproto.Field({{$r.FieldNumber}})),
            {{- else }}
                // m2o
                {{- if eq $r.Type "many" }}
                edge.To("{{$r.PluralName}}", {{$r.RelEntityName}}.Type).
                    Annotations(entproto.Field({{$r.FieldNumber}})),
                // o2o
                {{- else if eq $r.BackrefType "one" }}
                    edge.To("{{$r.Name|snakecase}}", {{$r.RelEntityName}}.Type).
                        // Bind the "{{$r.FieldName}}" field to this edge.
                        // Field("{{$r.FieldName|snakecase}}").
                        Unique().Annotations(entproto.Field({{$r.FieldNumber}})),
                {{- else if eq $r.BackrefType "one-nofk" }}
                    edge.From("{{$r.Name|snakecase}}", {{$r.RelEntityName}}.Type).
                        Ref("{{$r.Backref}}").
                        // Bind the "{{$r.FieldName}}" field to this edge.
                        // Field("{{$r.FieldName|snakecase}}").
                        Unique().Annotations(entproto.Field({{$r.FieldNumber}})),
                // o2m
                {{- else }}
                edge.From("{{$r.Name|snakecase}}", {{$r.RelEntityName}}.Type).
                    {{- if ne $r.Backref "" }}Ref("{{$r.Backref}}").{{- end }}
                    // Bind the "{{$r.FieldName}}" field to this edge.
                    // Field("{{$r.FieldName|snakecase}}").
                    Unique().Annotations(entproto.Field({{$r.FieldNumber}})),
                {{- end}}
            {{- end}}
        {{- end }}
    }
}
